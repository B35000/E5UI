{"version":3,"file":"static/js/789.ee22b861.chunk.js","mappings":"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","sources":["../node_modules/music-metadata/lib/ebml/types.js","../node_modules/music-metadata/lib/matroska/MatroskaDtd.js","../node_modules/music-metadata/lib/ebml/EbmlIterator.js","../node_modules/music-metadata/lib/matroska/MatroskaParser.js"],"sourcesContent":["export var DataType;\n(function (DataType) {\n    DataType[DataType[\"string\"] = 0] = \"string\";\n    DataType[DataType[\"uint\"] = 1] = \"uint\";\n    DataType[DataType[\"uid\"] = 2] = \"uid\";\n    DataType[DataType[\"bool\"] = 3] = \"bool\";\n    DataType[DataType[\"binary\"] = 4] = \"binary\";\n    DataType[DataType[\"float\"] = 5] = \"float\";\n})(DataType || (DataType = {}));\n//# sourceMappingURL=types.js.map","import { DataType } from '../ebml/types.js';\n/**\n * Elements of document type description\n * Derived from https://github.com/tungol/EBML/blob/master/doctypes/matroska.dtd\n * Extended with:\n * - https://www.matroska.org/technical/specs/index.html\n */\nexport const matroskaDtd = {\n    name: 'dtd',\n    container: {\n        0x1a45dfa3: {\n            name: 'ebml',\n            container: {\n                0x4286: { name: 'ebmlVersion', value: DataType.uint }, // 5.1.1\n                0x42f7: { name: 'ebmlReadVersion', value: DataType.uint }, // 5.1.2\n                0x42f2: { name: 'ebmlMaxIDWidth', value: DataType.uint }, // 5.1.3\n                0x42f3: { name: 'ebmlMaxSizeWidth', value: DataType.uint }, // 5.1.4\n                0x4282: { name: 'docType', value: DataType.string }, // 5.1.5\n                0x4287: { name: 'docTypeVersion', value: DataType.uint }, // 5.1.6\n                0x4285: { name: 'docTypeReadVersion', value: DataType.uint } // 5.1.7\n            }\n        },\n        // Matroska segments\n        0x18538067: {\n            name: 'segment',\n            container: {\n                // Meta Seek Information (also known as MetaSeek)\n                0x114d9b74: {\n                    name: 'seekHead',\n                    container: {\n                        0x4dbb: {\n                            name: 'seek',\n                            multiple: true,\n                            container: {\n                                0x53ab: { name: 'id', value: DataType.binary },\n                                0x53ac: { name: 'position', value: DataType.uint }\n                            }\n                        }\n                    }\n                },\n                // Segment Information\n                0x1549a966: {\n                    name: 'info',\n                    container: {\n                        0x73a4: { name: 'uid', value: DataType.uid },\n                        0x7384: { name: 'filename', value: DataType.string },\n                        0x3cb923: { name: 'prevUID', value: DataType.uid },\n                        0x3c83ab: { name: 'prevFilename', value: DataType.string },\n                        0x3eb923: { name: 'nextUID', value: DataType.uid },\n                        0x3e83bb: { name: 'nextFilename', value: DataType.string },\n                        0x2ad7b1: { name: 'timecodeScale', value: DataType.uint },\n                        0x4489: { name: 'duration', value: DataType.float },\n                        0x4461: { name: 'dateUTC', value: DataType.uint },\n                        0x7ba9: { name: 'title', value: DataType.string },\n                        0x4d80: { name: 'muxingApp', value: DataType.string },\n                        0x5741: { name: 'writingApp', value: DataType.string }\n                    }\n                },\n                // Cluster\n                0x1f43b675: {\n                    name: 'cluster',\n                    multiple: true,\n                    container: {\n                        0xe7: { name: 'timecode', value: DataType.uid },\n                        0x58d7: { name: 'silentTracks ', multiple: true },\n                        0xa7: { name: 'position', value: DataType.uid },\n                        0xab: { name: 'prevSize', value: DataType.uid },\n                        0xa0: { name: 'blockGroup' },\n                        0xa3: { name: 'simpleBlock' }\n                    }\n                },\n                // Track\n                0x1654ae6b: {\n                    name: 'tracks',\n                    container: {\n                        0xae: {\n                            name: 'entries',\n                            multiple: true,\n                            container: {\n                                0xd7: { name: 'trackNumber', value: DataType.uint },\n                                0x73c5: { name: 'uid', value: DataType.uid },\n                                0x83: { name: 'trackType', value: DataType.uint },\n                                0xb9: { name: 'flagEnabled', value: DataType.bool },\n                                0x88: { name: 'flagDefault', value: DataType.bool },\n                                0x55aa: { name: 'flagForced', value: DataType.bool }, // extended\n                                0x9c: { name: 'flagLacing', value: DataType.bool },\n                                0x6de7: { name: 'minCache', value: DataType.uint },\n                                0x6de8: { name: 'maxCache', value: DataType.uint },\n                                0x23e383: { name: 'defaultDuration', value: DataType.uint },\n                                0x23314f: { name: 'timecodeScale', value: DataType.float },\n                                0x536e: { name: 'name', value: DataType.string },\n                                0x22b59c: { name: 'language', value: DataType.string },\n                                0x86: { name: 'codecID', value: DataType.string },\n                                0x63a2: { name: 'codecPrivate', value: DataType.binary },\n                                0x258688: { name: 'codecName', value: DataType.string },\n                                0x3a9697: { name: 'codecSettings', value: DataType.string },\n                                0x3b4040: { name: 'codecInfoUrl', value: DataType.string },\n                                0x26b240: { name: 'codecDownloadUrl', value: DataType.string },\n                                0xaa: { name: 'codecDecodeAll', value: DataType.bool },\n                                0x6fab: { name: 'trackOverlay', value: DataType.uint },\n                                // Video\n                                0xe0: {\n                                    name: 'video',\n                                    container: {\n                                        0x9a: { name: 'flagInterlaced', value: DataType.bool },\n                                        0x53b8: { name: 'stereoMode', value: DataType.uint },\n                                        0xb0: { name: 'pixelWidth', value: DataType.uint },\n                                        0xba: { name: 'pixelHeight', value: DataType.uint },\n                                        0x54b0: { name: 'displayWidth', value: DataType.uint },\n                                        0x54ba: { name: 'displayHeight', value: DataType.uint },\n                                        0x54b3: { name: 'aspectRatioType', value: DataType.uint },\n                                        0x2eb524: { name: 'colourSpace', value: DataType.uint },\n                                        0x2fb523: { name: 'gammaValue', value: DataType.float }\n                                    }\n                                },\n                                // Audio\n                                0xe1: {\n                                    name: 'audio',\n                                    container: {\n                                        0xb5: { name: 'samplingFrequency', value: DataType.float },\n                                        0x78b5: { name: 'outputSamplingFrequency', value: DataType.float },\n                                        0x9f: { name: 'channels', value: DataType.uint }, // https://www.matroska.org/technical/specs/index.html\n                                        0x94: { name: 'channels', value: DataType.uint },\n                                        0x7d7b: { name: 'channelPositions', value: DataType.binary },\n                                        0x6264: { name: 'bitDepth', value: DataType.uint }\n                                    }\n                                },\n                                // Content Encoding\n                                0x6d80: {\n                                    name: 'contentEncodings',\n                                    container: {\n                                        0x6240: {\n                                            name: 'contentEncoding',\n                                            container: {\n                                                0x5031: { name: 'order', value: DataType.uint },\n                                                0x5032: { name: 'scope', value: DataType.bool },\n                                                0x5033: { name: 'type', value: DataType.uint },\n                                                0x5034: {\n                                                    name: 'contentEncoding',\n                                                    container: {\n                                                        0x4254: { name: 'contentCompAlgo', value: DataType.uint },\n                                                        0x4255: { name: 'contentCompSettings', value: DataType.binary }\n                                                    }\n                                                },\n                                                0x5035: {\n                                                    name: 'contentEncoding',\n                                                    container: {\n                                                        0x47e1: { name: 'contentEncAlgo', value: DataType.uint },\n                                                        0x47e2: { name: 'contentEncKeyID', value: DataType.binary },\n                                                        0x47e3: { name: 'contentSignature ', value: DataType.binary },\n                                                        0x47e4: { name: 'ContentSigKeyID  ', value: DataType.binary },\n                                                        0x47e5: { name: 'contentSigAlgo ', value: DataType.uint },\n                                                        0x47e6: { name: 'contentSigHashAlgo ', value: DataType.uint }\n                                                    }\n                                                },\n                                                0x6264: { name: 'bitDepth', value: DataType.uint }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                },\n                // Cueing Data\n                0x1c53bb6b: {\n                    name: 'cues',\n                    container: {\n                        0xbb: {\n                            name: 'cuePoint',\n                            container: {\n                                0xb3: { name: 'cueTime', value: DataType.uid },\n                                0xb7: {\n                                    name: 'positions',\n                                    container: {\n                                        0xf7: { name: 'track', value: DataType.uint },\n                                        0xf1: { name: 'clusterPosition', value: DataType.uint },\n                                        0x5378: { name: 'blockNumber', value: DataType.uint },\n                                        0xea: { name: 'codecState', value: DataType.uint },\n                                        0xdb: {\n                                            name: 'reference', container: {\n                                                0x96: { name: 'time', value: DataType.uint },\n                                                0x97: { name: 'cluster', value: DataType.uint },\n                                                0x535f: { name: 'number', value: DataType.uint },\n                                                0xeb: { name: 'codecState', value: DataType.uint }\n                                            }\n                                        },\n                                        0xf0: { name: 'relativePosition', value: DataType.uint } // extended\n                                    }\n                                }\n                            }\n                        }\n                    }\n                },\n                // Attachment\n                0x1941a469: {\n                    name: 'attachments',\n                    container: {\n                        0x61a7: {\n                            name: 'attachedFiles',\n                            multiple: true,\n                            container: {\n                                0x467e: { name: 'description', value: DataType.string },\n                                0x466e: { name: 'name', value: DataType.string },\n                                0x4660: { name: 'mimeType', value: DataType.string },\n                                0x465c: { name: 'data', value: DataType.binary },\n                                0x46ae: { name: 'uid', value: DataType.uid }\n                            }\n                        }\n                    }\n                },\n                // Chapters\n                0x1043a770: {\n                    name: 'chapters',\n                    container: {\n                        0x45b9: {\n                            name: 'editionEntry',\n                            container: {\n                                0xb6: {\n                                    name: 'chapterAtom',\n                                    container: {\n                                        0x73c4: { name: 'uid', value: DataType.uid },\n                                        0x91: { name: 'timeStart', value: DataType.uint },\n                                        0x92: { name: 'timeEnd', value: DataType.uid },\n                                        0x98: { name: 'hidden', value: DataType.bool },\n                                        0x4598: { name: 'enabled', value: DataType.uid },\n                                        0x8f: {\n                                            name: 'track', container: {\n                                                0x89: { name: 'trackNumber', value: DataType.uid },\n                                                0x80: {\n                                                    name: 'display', container: {\n                                                        0x85: { name: 'string', value: DataType.string },\n                                                        0x437c: { name: 'language ', value: DataType.string },\n                                                        0x437e: { name: 'country ', value: DataType.string }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                },\n                // Tagging\n                0x1254c367: {\n                    name: 'tags',\n                    container: {\n                        0x7373: {\n                            name: 'tag',\n                            multiple: true,\n                            container: {\n                                0x63c0: {\n                                    name: 'target',\n                                    container: {\n                                        0x63c5: { name: 'tagTrackUID', value: DataType.uid },\n                                        0x63c4: { name: 'tagChapterUID', value: DataType.uint },\n                                        0x63c6: { name: 'tagAttachmentUID', value: DataType.uid },\n                                        0x63ca: { name: 'targetType', value: DataType.string }, // extended\n                                        0x68ca: { name: 'targetTypeValue', value: DataType.uint }, // extended\n                                        0x63c9: { name: 'tagEditionUID', value: DataType.uid } // extended\n                                    }\n                                },\n                                0x67c8: {\n                                    name: 'simpleTags',\n                                    multiple: true,\n                                    container: {\n                                        0x45a3: { name: 'name', value: DataType.string },\n                                        0x4487: { name: 'string', value: DataType.string },\n                                        0x4485: { name: 'binary', value: DataType.binary },\n                                        0x447a: { name: 'language', value: DataType.string }, // extended\n                                        0x447b: { name: 'languageIETF', value: DataType.string }, // extended\n                                        0x4484: { name: 'default', value: DataType.bool } // extended\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n};\n//# sourceMappingURL=MatroskaDtd.js.map","import { Float32_BE, Float64_BE, StringType, UINT8 } from 'token-types';\nimport initDebug from 'debug';\nimport { EndOfStreamError } from 'strtok3';\nimport { DataType } from './types.js';\nimport * as Token from 'token-types';\nimport { makeUnexpectedFileContentError } from '../ParseError.js';\nconst debug = initDebug('music-metadata:parser:ebml');\nexport class EbmlContentError extends makeUnexpectedFileContentError('EBML') {\n}\nexport var ParseAction;\n(function (ParseAction) {\n    ParseAction[ParseAction[\"ReadNext\"] = 0] = \"ReadNext\";\n    ParseAction[ParseAction[\"IgnoreElement\"] = 2] = \"IgnoreElement\";\n    ParseAction[ParseAction[\"SkipSiblings\"] = 3] = \"SkipSiblings\";\n    ParseAction[ParseAction[\"TerminateParsing\"] = 4] = \"TerminateParsing\";\n    ParseAction[ParseAction[\"SkipElement\"] = 5] = \"SkipElement\"; // Consider the element has read, assume position is at the next element\n})(ParseAction || (ParseAction = {}));\n/**\n * Extensible Binary Meta Language (EBML) iterator\n * https://en.wikipedia.org/wiki/Extensible_Binary_Meta_Language\n * http://matroska.sourceforge.net/technical/specs/rfc/index.html\n *\n * WEBM VP8 AUDIO FILE\n */\nexport class EbmlIterator {\n    /**\n     * @param {ITokenizer} tokenizer Input\n     * @param tokenizer\n     */\n    constructor(tokenizer) {\n        this.tokenizer = tokenizer;\n        this.padding = 0;\n        this.parserMap = new Map();\n        this.ebmlMaxIDLength = 4;\n        this.ebmlMaxSizeLength = 8;\n        this.parserMap.set(DataType.uint, e => this.readUint(e));\n        this.parserMap.set(DataType.string, e => this.readString(e));\n        this.parserMap.set(DataType.binary, e => this.readBuffer(e));\n        this.parserMap.set(DataType.uid, async (e) => this.readBuffer(e));\n        this.parserMap.set(DataType.bool, e => this.readFlag(e));\n        this.parserMap.set(DataType.float, e => this.readFloat(e));\n    }\n    async iterate(dtdElement, posDone, listener) {\n        return this.parseContainer(linkParents(dtdElement), posDone, listener);\n    }\n    async parseContainer(dtdElement, posDone, listener) {\n        const tree = {};\n        while (this.tokenizer.position < posDone) {\n            let element;\n            const elementPosition = this.tokenizer.position;\n            try {\n                element = await this.readElement();\n            }\n            catch (error) {\n                if (error instanceof EndOfStreamError) {\n                    break;\n                }\n                throw error;\n            }\n            const child = dtdElement.container[element.id];\n            if (child) {\n                const action = listener.startNext(child);\n                switch (action) {\n                    case ParseAction.ReadNext:\n                        {\n                            if (element.id === 0x1F43B675) {\n                                // Hack to ignore remaining segment, when cluster element received\n                                // await this.tokenizer.ignore(posDone - this.tokenizer.position);\n                                // break;\n                            }\n                            debug(`Read element: name=${getElementPath(child)}{id=0x${element.id.toString(16)}, container=${!!child.container}} at position=${elementPosition}`);\n                            if (child.container) {\n                                const res = await this.parseContainer(child, element.len >= 0 ? this.tokenizer.position + element.len : -1, listener);\n                                if (child.multiple) {\n                                    if (!tree[child.name]) {\n                                        tree[child.name] = [];\n                                    }\n                                    tree[child.name].push(res);\n                                }\n                                else {\n                                    tree[child.name] = res;\n                                }\n                                await listener.elementValue(child, res, elementPosition);\n                            }\n                            else {\n                                const parser = this.parserMap.get(child.value);\n                                if (typeof parser === 'function') {\n                                    const value = await parser(element);\n                                    tree[child.name] = value;\n                                    await listener.elementValue(child, value, elementPosition);\n                                }\n                            }\n                        }\n                        break;\n                    case ParseAction.SkipElement:\n                        debug(`Go to next element: name=${getElementPath(child)}, element.id=0x${element.id}, container=${!!child.container} at position=${elementPosition}`);\n                        break;\n                    case ParseAction.IgnoreElement:\n                        debug(`Ignore element: name=${getElementPath(child)}, element.id=0x${element.id}, container=${!!child.container} at position=${elementPosition}`);\n                        await this.tokenizer.ignore(element.len);\n                        break;\n                    case ParseAction.SkipSiblings:\n                        debug(`Ignore remaining container, at: name=${getElementPath(child)}, element.id=0x${element.id}, container=${!!child.container} at position=${elementPosition}`);\n                        await this.tokenizer.ignore(posDone - this.tokenizer.position);\n                        break;\n                    case ParseAction.TerminateParsing:\n                        debug(`Terminate parsing at element: name=${getElementPath(child)}, element.id=0x${element.id}, container=${!!child.container} at position=${elementPosition}`);\n                        return tree;\n                }\n            }\n            else {\n                switch (element.id) {\n                    case 0xec: // void\n                        this.padding += element.len;\n                        await this.tokenizer.ignore(element.len);\n                        break;\n                    default:\n                        debug(`parseEbml: parent=${getElementPath(dtdElement)}, unknown child: id=${element.id.toString(16)} at position=${elementPosition}`);\n                        this.padding += element.len;\n                        await this.tokenizer.ignore(element.len);\n                }\n            }\n        }\n        return tree;\n    }\n    async readVintData(maxLength) {\n        const msb = await this.tokenizer.peekNumber(UINT8);\n        let mask = 0x80;\n        let oc = 1;\n        // Calculate VINT_WIDTH\n        while ((msb & mask) === 0) {\n            if (oc > maxLength) {\n                throw new EbmlContentError('VINT value exceeding maximum size');\n            }\n            ++oc;\n            mask >>= 1;\n        }\n        const id = new Uint8Array(oc);\n        await this.tokenizer.readBuffer(id);\n        return id;\n    }\n    async readElement() {\n        const id = await this.readVintData(this.ebmlMaxIDLength);\n        const lenField = await this.readVintData(this.ebmlMaxSizeLength);\n        lenField[0] ^= 0x80 >> (lenField.length - 1);\n        return {\n            id: readUIntBE(id, id.length),\n            len: readUIntBE(lenField, lenField.length)\n        };\n    }\n    async readFloat(e) {\n        switch (e.len) {\n            case 0:\n                return 0.0;\n            case 4:\n                return this.tokenizer.readNumber(Float32_BE);\n            case 8:\n                return this.tokenizer.readNumber(Float64_BE);\n            case 10:\n                return this.tokenizer.readNumber(Float64_BE);\n            default:\n                throw new EbmlContentError(`Invalid IEEE-754 float length: ${e.len}`);\n        }\n    }\n    async readFlag(e) {\n        return (await this.readUint(e)) === 1;\n    }\n    async readUint(e) {\n        const buf = await this.readBuffer(e);\n        return readUIntBE(buf, e.len);\n    }\n    async readString(e) {\n        const rawString = await this.tokenizer.readToken(new StringType(e.len, 'utf-8'));\n        return rawString.replace(/\\x00.*$/g, '');\n    }\n    async readBuffer(e) {\n        const buf = new Uint8Array(e.len);\n        await this.tokenizer.readBuffer(buf);\n        return buf;\n    }\n}\nfunction readUIntBE(buf, len) {\n    return Number(readUIntBeAsBigInt(buf, len));\n}\n/**\n * Reeds an unsigned integer from a big endian buffer of length `len`\n * @param buf Buffer to decode from\n * @param len Number of bytes\n * @private\n */\nfunction readUIntBeAsBigInt(buf, len) {\n    const normalizedNumber = new Uint8Array(8);\n    const cleanNumber = buf.subarray(0, len);\n    try {\n        normalizedNumber.set(cleanNumber, 8 - len);\n        return Token.UINT64_BE.get(normalizedNumber, 0);\n    }\n    catch (error) {\n        return BigInt(-1);\n    }\n}\nfunction linkParents(element) {\n    if (element.container) {\n        Object.keys(element.container)\n            .map(id => {\n            const child = element.container[id];\n            child.id = Number.parseInt(id);\n            return child;\n        }).forEach(child => {\n            child.parent = element;\n            linkParents(child);\n        });\n    }\n    return element;\n}\nexport function getElementPath(element) {\n    let path = '';\n    if (element.parent && element.parent.name !== 'dtd') {\n        path += `${getElementPath(element.parent)}/`;\n    }\n    return path + element.name;\n}\n//# sourceMappingURL=EbmlIterator.js.map","import initDebug from 'debug';\nimport { BasicParser } from '../common/BasicParser.js';\nimport { matroskaDtd } from './MatroskaDtd.js';\nimport { TargetType, TrackType } from './types.js';\nimport { EbmlIterator, ParseAction } from '../ebml/EbmlIterator.js';\nconst debug = initDebug('music-metadata:parser:matroska');\n/**\n * Extensible Binary Meta Language (EBML) parser\n * https://en.wikipedia.org/wiki/Extensible_Binary_Meta_Language\n * http://matroska.sourceforge.net/technical/specs/rfc/index.html\n *\n * WEBM VP8 AUDIO FILE\n */\nexport class MatroskaParser extends BasicParser {\n    constructor() {\n        super(...arguments);\n        this.seekHeadOffset = 0;\n        /**\n         * Use index to skip multiple segment/cluster elements at once.\n         * Significant performance impact\n         */\n        this.flagUseIndexToSkipClusters = this.options.mkvUseIndex ?? false;\n    }\n    async parse() {\n        const containerSize = this.tokenizer.fileInfo.size ?? Number.MAX_SAFE_INTEGER;\n        const matroskaIterator = new EbmlIterator(this.tokenizer);\n        debug('Initializing DTD end MatroskaIterator');\n        await matroskaIterator.iterate(matroskaDtd, containerSize, {\n            startNext: (element) => {\n                switch (element.id) {\n                    // case 0x1f43b675: // cluster\n                    case 0x1c53bb6b: // Cueing Data\n                        debug(`Skip element: name=${element.name}, id=0x${element.id.toString(16)}`);\n                        return ParseAction.IgnoreElement;\n                    case 0x1f43b675: // cluster\n                        if (this.flagUseIndexToSkipClusters && this.seekHead) {\n                            const index = this.seekHead.seek.find(index => index.position + this.seekHeadOffset > this.tokenizer.position);\n                            if (index) {\n                                // Go to next index position\n                                const ignoreSize = index.position + this.seekHeadOffset - this.tokenizer.position;\n                                debug(`Use index to go to next position, ignoring ${ignoreSize} bytes`);\n                                this.tokenizer.ignore(ignoreSize);\n                                return ParseAction.SkipElement;\n                            }\n                        }\n                        return ParseAction.IgnoreElement;\n                    default:\n                        return ParseAction.ReadNext;\n                }\n            },\n            elementValue: async (element, value, offset) => {\n                debug(`Received: name=${element.name}, value=${value}`);\n                switch (element.id) {\n                    case 0x4282: // docType\n                        this.metadata.setFormat('container', `EBML/${value}`);\n                        break;\n                    case 0x114d9b74:\n                        this.seekHead = value;\n                        this.seekHeadOffset = offset;\n                        break;\n                    case 0x1549a966:\n                        { // Info (Segment Information)\n                            const info = value;\n                            const timecodeScale = info.timecodeScale ? info.timecodeScale : 1000000;\n                            if (typeof info.duration === 'number') {\n                                const duration = info.duration * timecodeScale / 1000000000;\n                                await this.addTag('segment:title', info.title);\n                                this.metadata.setFormat('duration', Number(duration));\n                            }\n                        }\n                        break;\n                    case 0x1654ae6b:\n                        { // tracks\n                            const audioTracks = value;\n                            if (audioTracks?.entries) {\n                                audioTracks.entries.forEach(entry => {\n                                    const stream = {\n                                        codecName: entry.codecID.replace('A_', '').replace('V_', ''),\n                                        codecSettings: entry.codecSettings,\n                                        flagDefault: entry.flagDefault,\n                                        flagLacing: entry.flagLacing,\n                                        flagEnabled: entry.flagEnabled,\n                                        language: entry.language,\n                                        name: entry.name,\n                                        type: entry.trackType,\n                                        audio: entry.audio,\n                                        video: entry.video\n                                    };\n                                    this.metadata.addStreamInfo(stream);\n                                });\n                                const audioTrack = audioTracks.entries\n                                    .filter(entry => entry.trackType === TrackType.audio)\n                                    .reduce((acc, cur) => {\n                                    if (!acc)\n                                        return cur;\n                                    if (cur.flagDefault && !acc.flagDefault)\n                                        return cur;\n                                    if (cur.trackNumber < acc.trackNumber)\n                                        return cur;\n                                    return acc;\n                                }, null);\n                                if (audioTrack) {\n                                    this.metadata.setFormat('codec', audioTrack.codecID.replace('A_', ''));\n                                    this.metadata.setFormat('sampleRate', audioTrack.audio.samplingFrequency);\n                                    this.metadata.setFormat('numberOfChannels', audioTrack.audio.channels);\n                                }\n                            }\n                        }\n                        break;\n                    case 0x1254c367:\n                        { // tags\n                            const tags = value;\n                            await Promise.all(tags.tag.map(async (tag) => {\n                                const target = tag.target;\n                                const targetType = target?.targetTypeValue ? TargetType[target.targetTypeValue] : (target?.targetType ? target.targetType : 'track');\n                                await Promise.all(tag.simpleTags.map(async (simpleTag) => {\n                                    const value = simpleTag.string ? simpleTag.string : simpleTag.binary;\n                                    await this.addTag(`${targetType}:${simpleTag.name}`, value);\n                                }));\n                            }));\n                        }\n                        break;\n                    case 0x1941a469:\n                        { // attachments\n                            const attachments = value;\n                            await Promise.all(attachments.attachedFiles\n                                .filter(file => file.mimeType.startsWith('image/'))\n                                .map(file => this.addTag('picture', {\n                                data: file.data,\n                                format: file.mimeType,\n                                description: file.description,\n                                name: file.name\n                            })));\n                        }\n                        break;\n                }\n            }\n        });\n    }\n    async addTag(tagId, value) {\n        await this.metadata.addTag('matroska', tagId, value);\n    }\n}\n//# sourceMappingURL=MatroskaParser.js.map"],"names":["DataType","matroskaDtd","name","container","value","uint","string","multiple","binary","uid","float","bool","debug","initDebug","EbmlContentError","makeUnexpectedFileContentError","ParseAction","EbmlIterator","constructor","tokenizer","this","padding","parserMap","Map","ebmlMaxIDLength","ebmlMaxSizeLength","set","e","readUint","readString","readBuffer","async","readFlag","readFloat","iterate","dtdElement","posDone","listener","parseContainer","linkParents","tree","position","element","elementPosition","readElement","error","EndOfStreamError","child","id","startNext","ReadNext","getElementPath","toString","res","len","push","elementValue","parser","get","SkipElement","IgnoreElement","ignore","SkipSiblings","TerminateParsing","readVintData","maxLength","msb","peekNumber","UINT8","mask","oc","Uint8Array","lenField","length","readUIntBE","readNumber","Float32_BE","Float64_BE","readToken","StringType","replace","buf","Number","normalizedNumber","cleanNumber","subarray","Token","BigInt","readUIntBeAsBigInt","Object","keys","map","parseInt","forEach","parent","path","MatroskaParser","BasicParser","super","arguments","seekHeadOffset","flagUseIndexToSkipClusters","options","mkvUseIndex","parse","containerSize","fileInfo","size","MAX_SAFE_INTEGER","matroskaIterator","seekHead","index","seek","find","ignoreSize","offset","metadata","setFormat","info","timecodeScale","duration","addTag","title","audioTracks","entries","entry","stream","codecName","codecID","codecSettings","flagDefault","flagLacing","flagEnabled","language","type","trackType","audio","video","addStreamInfo","audioTrack","filter","TrackType","reduce","acc","cur","trackNumber","samplingFrequency","channels","tags","Promise","all","tag","target","targetType","targetTypeValue","TargetType","simpleTags","simpleTag","attachments","attachedFiles","file","mimeType","startsWith","data","format","description","tagId"],"sourceRoot":""}